<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<title>增删改查</title>
		<link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">
		<link rel="stylesheet" href="./style/index.css"/>
		<script src="./javascript/vue.js"></script>
		<script src="https://unpkg.com/element-ui/lib/index.js"></script>
		<!-- <script src="./javascript/index.js"></script> -->
	</head>
	<body>
		<div id="app">
			<h1>同学录</h1>
			<div class="head">
				<el-row :gutter="20">
				  <el-col :span="6">
					<el-input v-model="userInfo.name" placeholder="请输入姓名"></el-input>
				  </el-col>
				  <el-col :span="6">
					<el-input v-model="userInfo.gender" placeholder="请输入性别"></el-input>
				  </el-col>
				  <el-col :span="6">
					<el-input v-model="userInfo.phoneNum" placeholder="请输入电话号码"></el-input>
				  </el-col>
				  <el-col :span="6">
					 <el-date-picker
					      v-model="userInfo.birthday"
					      type="date"
					      format="yyyy 年 MM 月 dd 日"
					      value-format="yyyy-MM-dd"
					      placeholder="选择日期">
					    </el-date-picker>
				  </el-col>
				</el-row>
				 <el-button type="primary" class="add-btn" @click="addUser">添加信息</el-button>
			</div>
			<div class="body">
				<template>
				    <el-table
				      :data="tableData"
				      style="width: 100%">
				      <el-table-column
				        label="序号"
				        width="180">
						<template slot-scope="scope">
							{{scope.$index+1}}
						</template>
				      </el-table-column>
				      <el-table-column
				        prop="name"
				        label="姓名"
				        width="180">
				      </el-table-column>
				      <el-table-column
				        prop="gender"
				        label="性别">
				      </el-table-column>
					  <el-table-column
				        prop="phoneNum"
				        label="电话号码">
				      </el-table-column>
					  <el-table-column
				        prop="birthday"
				        label="生日">
				      </el-table-column>
					  <el-table-column
					    prop="birthday"
					    label="操作">
						<template slot-scope="scope">
							<el-button type="primary" icon="el-icon-edit" circle @click="editUser(scope.row,scope.$index)"></el-button>
							<el-button type="danger" icon="el-icon-delete" circle @click="delUser(scope.$index)"></el-button>
						</template>
					  </el-table-column>
				    </el-table>
				</template>
			</div>
			<el-dialog
			  title="编辑用户信息"
			  :visible.sync="dialogVisible"
			  width="30%"
			  :before-close="handleClose">
			  <div>
				  <el-form ref="form" label-width="80px">
				  <el-form-item label="姓名">
				    <el-input v-model="editObj.name"></el-input>
				  </el-form-item>
				  <el-form-item label="性别">
				    <el-input v-model="editObj.gender"></el-input>
				  </el-form-item>
				  <el-form-item label="电话号码">
				    <el-input v-model="editObj.phoneNum"></el-input>
				  </el-form-item>
				  <el-form-item label="生日">
				  <el-date-picker
				       v-model="editObj.birthday"
				       type="date"
				       format="yyyy 年 MM 月 dd 日"
				       value-format="yyyy-MM-dd"
				       placeholder="选择日期">
				     </el-date-picker>
				  </el-form-item>
				  </el-form>
			  </div>
			  <span slot="footer" class="dialog-footer">
			    <el-button @click="dialogVisible = false">取 消</el-button>
			    <el-button type="primary" @click="confirm">确 定</el-button>
			  </span>
			</el-dialog>
		</div>
		<script>
			new Vue({
				el: '#app',
				data:function() {
					return {
						userInfo:{
							name:'',
							gender:'',
							phoneNum:'',
							birthday:'',
						}, 
						tableData: [{
						  name: '风花雪月',
						  gender:'女',
						  phoneNum:'13956945030',
						  birthday:'2002-06-16'
						}],
						dialogVisible:false,
						editObj:{
							name:'',
							gender:'',
							phoneNum:'',
							birthday:''
						}
					};
				},
				methods: {
					addUser(){
						if(!this.userInfo.name){
							this.$message({
							  message: '请输入姓名',
							  type: 'warning',
							});
							return;
						}
						if(!this.userInfo.gender){
							this.$message({
							  message: '请输入性别',
							  type: 'warning',
							});
							return;
						}
						if(!/^1[3456789]\d{9}$/.test(this.userInfo.phoneNum)){
							this.$message({
							  message: '请输入正确的电话号码',
							  type: 'warning',
							});
							return;
						}
						if(!this.userInfo.birthday){
							this.$message({
							  message: '请输入生日',
							  type: 'warning',
							});
							return;
						}
						this.tableData.push(this.userInfo);
						this.userInfo={
							name:'',
							gender:'',
							phoneNum:'',
							birthday:'',
						}
					},
					delUser(idx){
						this.$confirm('确认删除？')
						  .then(_ => {
						    this.tableData.splice(idx,1)
						  })
						  .catch(_ => {});
					},
					editUser(item,idx){
						this.userIndex=idx;
						this.editObj={
							name:item.name,
							gender:item.gender,
							phoneNum:item.phoneNum,
							birthday:item.birthday,
						}
						this.dialogVisible=true;
					},
					handleClose(){
						this.dialogVisible=false;
					},
					confirm(){
						if(!this.editObj.name){
							this.$message({
							  message: '请输入姓名',
							  type: 'warning',
							});
							return;
						}
						if(!this.editObj.gender){
							this.$message({
							  message: '请输入性别',
							  type: 'warning',
							});
							return;
						}
						if(!/^1[3456789]\d{9}$/.test(this.editObj.phoneNum)){
							this.$message({
							  message: '请输入正确的电话号码',
							  type: 'warning',
							});
							return;
						}
						if(!this.editObj.birthday){
							this.$message({
							  message: '请输入生日',
							  type: 'warning',
							});
							return;
						}
						Vue.set(this.tableData,this.userIndex,this.editObj);
						this.dialogVisible=false;
					}
				}
			})
		</script>
	</body>
</html>
